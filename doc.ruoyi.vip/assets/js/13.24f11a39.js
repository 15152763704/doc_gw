(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{417:function(s,t,a){"use strict";a.r(t);var n=a(56),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"条件编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#条件编译"}},[s._v("#")]),s._v(" 条件编译")]),s._v(" "),a("p",[s._v("条件编译是用特殊的注释作为标记，在编译时根据这些特殊的注释，将注释里面的代码编译到不同平台。")]),s._v(" "),a("p",[s._v("写法以"),a("code",[s._v("#ifdef")]),s._v("或"),a("code",[s._v("#ifndef")]),s._v("加"),a("code",[s._v("%PLATFORM%")]),s._v("开头，以"),a("code",[s._v("#endif")]),s._v("结尾。")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("#ifdef")]),s._v("：if defined 仅在某平台存在")]),s._v(" "),a("li",[a("code",[s._v("#ifndef")]),s._v("：if not defined 除了某平台均存在")]),s._v(" "),a("li",[a("code",[s._v("%PLATFORM%")]),s._v("：平台名称")])]),s._v(" "),a("p",[s._v("仅出现在"),a("code",[s._v("App平台")]),s._v("下的代码")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("#ifdef "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("APP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PLUS")]),s._v("\n需条件编译的代码\n#endif\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("除了"),a("code",[s._v("H5平台")]),s._v("，其它平台均存在的代码")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("#ifndef "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("H5")]),s._v("\n需条件编译的代码\n#endif\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("在"),a("code",[s._v("H5平台")]),s._v("或"),a("code",[s._v("微信小程序平台")]),s._v("存在的代码")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("#ifdef "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("H5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WEIXIN")]),s._v("\n需条件编译的代码\n#endif\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("多个这里只有"),a("code",[s._v("||")]),s._v("，不可能出现"),a("code",[s._v("&&")]),s._v("，因为没有交集。")])]),s._v(" "),a("h2",{attrs:{id:"平台名称参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#平台名称参数"}},[s._v("#")]),s._v(" 平台名称参数")]),s._v(" "),a("p",[a("code",[s._v("%PLATFORM%")]),s._v("可取值如下：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("值")]),s._v(" "),a("th",[s._v("生效条件")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("VUE3")]),s._v(" "),a("td",[s._v("Vue3")])]),s._v(" "),a("tr",[a("td",[s._v("APP-PLUS")]),s._v(" "),a("td",[s._v("App")])]),s._v(" "),a("tr",[a("td",[s._v("APP-PLUS-NVUE或APP-NVUE")]),s._v(" "),a("td",[s._v("App nvue")])]),s._v(" "),a("tr",[a("td",[s._v("H5")]),s._v(" "),a("td",[s._v("H5")])]),s._v(" "),a("tr",[a("td",[s._v("MP-WEIXIN")]),s._v(" "),a("td",[s._v("微信小程序")])]),s._v(" "),a("tr",[a("td",[s._v("MP-ALIPAY")]),s._v(" "),a("td",[s._v("支付宝小程序")])]),s._v(" "),a("tr",[a("td",[s._v("MP-BAIDU")]),s._v(" "),a("td",[s._v("百度小程序")])]),s._v(" "),a("tr",[a("td",[s._v("MP-TOUTIAO")]),s._v(" "),a("td",[s._v("字节跳动小程序")])]),s._v(" "),a("tr",[a("td",[s._v("MP-LARK")]),s._v(" "),a("td",[s._v("飞书小程序")])]),s._v(" "),a("tr",[a("td",[s._v("MP-QQ")]),s._v(" "),a("td",[s._v("QQ小程序")])]),s._v(" "),a("tr",[a("td",[s._v("MP-KUAISHOU")]),s._v(" "),a("td",[s._v("快手小程序")])]),s._v(" "),a("tr",[a("td",[s._v("MP-JD")]),s._v(" "),a("td",[s._v("京东小程序")])]),s._v(" "),a("tr",[a("td",[s._v("MP-360")]),s._v(" "),a("td",[s._v("360小程序")])]),s._v(" "),a("tr",[a("td",[s._v("MP")]),s._v(" "),a("td",[s._v("所有小程序")])]),s._v(" "),a("tr",[a("td",[s._v("QUICKAPP-WEBVIEW")]),s._v(" "),a("td",[s._v("所有快应用")])]),s._v(" "),a("tr",[a("td",[s._v("QUICKAPP-WEBVIEW-UNION")]),s._v(" "),a("td",[s._v("快应用联盟")])]),s._v(" "),a("tr",[a("td",[s._v("QUICKAPP-WEBVIEW-HUAWEI")]),s._v(" "),a("td",[s._v("快应用华为")])])])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[a("code",[s._v("Vue3")]),s._v("需要在项目的"),a("code",[s._v("manifest.json")]),s._v("文件根节点配置"),a("code",[s._v('"vueVersion" : "3"')])])]),s._v(" "),a("h2",{attrs:{id:"api-的条件编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api-的条件编译"}},[s._v("#")]),s._v(" API 的条件编译")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// #ifdef  %PLATFORM%")]),s._v("\n平台特有的"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("API")]),s._v("实现\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// #endif")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("示例，如下代码仅在"),a("code",[s._v("App")]),s._v("下出现:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/07834e90-4f3c-11eb-b680-7980c8a877b8.png",alt:""}})]),s._v(" "),a("p",[s._v("示例，如下代码不会在"),a("code",[s._v("H5")]),s._v("平台上出现:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/06a79490-4f3c-11eb-b680-7980c8a877b8.png",alt:""}})]),s._v(" "),a("p",[s._v("除了支持单个平台的条件编译外，还支持"),a("code",[s._v("多平台")]),s._v("同时编译，使用"),a("code",[s._v("||")]),s._v("来分隔平台名称。")]),s._v(" "),a("p",[s._v("示例，如下代码会在"),a("code",[s._v("App")]),s._v("和"),a("code",[s._v("H5")]),s._v("平台上出现:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/05c1ef80-4f3c-11eb-b680-7980c8a877b8.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"组件的条件编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件的条件编译"}},[s._v("#")]),s._v(" 组件的条件编译")]),s._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--  #ifdef  %PLATFORM% --\x3e")]),s._v("\n平台特有的组件\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--  #endif --\x3e")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("示例，如下公众号关注组件仅会在微信小程序中出现:")]),s._v(" "),a("div",{staticClass:"language-vue line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("微信公众号关注组件"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- #ifdef MP-WEIXIN --\x3e")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("official-account")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("official-account")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- #endif --\x3e")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"样式的条件编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#样式的条件编译"}},[s._v("#")]),s._v(" 样式的条件编译")]),s._v(" "),a("div",{staticClass:"language-css line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*  #ifdef  %PLATFORM%  */")]),s._v("\n平台特有样式\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*  #endif  */")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("注意：")]),s._v(" 样式的条件编译，无论是 css 还是 sass/scss/less/stylus 等预编译语言中，必须使用 "),a("code",[s._v("/*注释*/")]),s._v(" 的写法。")]),s._v(" "),a("p",[s._v("正确写法")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/0bd78d80-4f3c-11eb-a16f-5b3e54966275.png",alt:""}})]),s._v(" "),a("p",[s._v("错误写法")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/0c9c8b30-4f3c-11eb-8a36-ebb87efcf8c0.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"pages-json-的条件编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pages-json-的条件编译"}},[s._v("#")]),s._v(" pages.json 的条件编译")]),s._v(" "),a("p",[s._v("下面的页面，只有运行至"),a("code",[s._v("App")]),s._v("时才会编译进去。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://bjetxgzv.cdn.bspapp.com/VKCEYUGU-uni-app-doc/04ecec40-4f3c-11eb-97b7-0dc4655d6e68.png",alt:""}})]),s._v(" "),a("p",[s._v("不同平台下的特有功能，以及小程序平台的分包，都可以通过 pages.json 的条件编译来更好地实现。这样，就不会在其它平台产生多余的资源，进而减小包体积。")]),s._v(" "),a("p",[s._v("json的条件编译，如不同平台的key名称相同，cli项目下开发者自己安装的校验器会报错，需自行关闭这些校验器对json相同key的校验规则。如果使用HBuilderX的校验器，无需在意此问题，HBuilderX的语法校验器为此优化过。")]),s._v(" "),a("h2",{attrs:{id:"static-目录的条件编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#static-目录的条件编译"}},[s._v("#")]),s._v(" static 目录的条件编译")]),s._v(" "),a("p",[s._v("在不同平台，引用的静态资源可能也存在差异，通过 static 的的条件编译可以解决此问题，static 目录下新建不同平台的专有目录（目录名称同"),a("code",[s._v("%PLATFORM%")]),s._v("值域,但字母均为小写），专有目录下的静态资源只有在特定平台才会编译进去。")]),s._v(" "),a("p",[s._v("如以下目录结构，"),a("code",[s._v("a.png")]),s._v("只有在微信小程序平台才会编译进去，"),a("code",[s._v("b.png")]),s._v("在所有平台都会被编译。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("┌─static                \n│  ├─mp-weixin\n│  │  └─a.png     \n│  └─b.png\n├─main.js        \n├─App.vue      \n├─manifest.json \n└─pages.json   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"整体目录条件编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#整体目录条件编译"}},[s._v("#")]),s._v(" 整体目录条件编译")]),s._v(" "),a("p",[s._v("如果想把各平台的页面文件更彻底的分开，也可以在ruoyi-app项目根目录创建"),a("code",[s._v("platforms")]),s._v("目录，然后在下面进一步创建"),a("code",[s._v("app-plus")]),s._v("、"),a("code",[s._v("mp-weixin")]),s._v("等子目录，存放不同平台的文件。")]),s._v(" "),a("p",[a("code",[s._v("platforms")]),s._v("目录下只支持放置页面文件（即页面vue文件），如果需要对其他资源条件编译建议使用"),a("code",[s._v("static 目录的条件编译")]),s._v("。")])])}),[],!1,null,null,null);t.default=e.exports}}]);